{"version":3,"sources":["ChordButtons.module.scss","AudioFontPlayer.ts","chords.ts","ChordButtons.tsx","ChordView.tsx","useDebounce.ts","Sliders.tsx","Sustain.tsx","App.tsx","reportWebVitals.ts","index.tsx","Sustain.module.scss","ChordView.module.scss","Sliders.module.scss","App.module.scss"],"names":["module","exports","soundFont","window","_tone_0411_FluidR3_GM_sf2_file","AudioFontPlayer","constructor","player","audioContext","envelopes","volume","playbackRate","duration","AudioContextFunc","AudioContext","webkitAudioContext","this","WebAudioFontPlayer","loader","decodeAfterLoading","console","log","queueNote","note","zone","findZone","baseDetune","originalPitch","coarseTune","fineTune","Math","pow","envelope","queueWaveTable","destination","audioBufferSourceNode","cancelScheduledValues","setValueAtTime","push","playChord","pitches","stop","forEach","pitch","pop","cancel","length","setFreq","freq","map","e","setVolume","setDuration","NOTES","NOTES_CHROMATIC_ORDER","NOTES_FIFTHS_ORDER","CHORDTYPES","TUNING","CHORD_DB","createNotesArr","notes","arr","n","sort","a","b","threeNoteChordItem","base","type","fourNoteChordItem","fourth","i","createDb","getChords","p","filter","item","isEqual","r","getDifficulty","reduce","prev","curr","VALID_CHORDS","positionsToPitches","positions","t","getAlternativeNames","c","j","k","chord","Array","isArray","init","CHROMATIC_KEYMAP","CHROMATIC_KEYMAP_CODES","FIFTHS_KEYMAP","FIFTHS_KEYMAP_CODES_MAJOR","FIFTHS_KEYMAP_CODES_MINOR","FIFTHS_KEYMAP_CODES_SEVENTH","ChordButtons","props","activeNote","activeType","pendingType","layout","setLayout","onClick","onStop","keymap","className","styles","chordbuttons","key","_","typeIndex","order","isButtonActive","noteIndex","pending","active","renderButtons","colSpan","name","value","checked","onChange","target","ChordView","isChecked","getNote","baseNote","pos","index","wrapper","chordview","readOnly","fill","names","Fragment","useDebounce","delay","debouncedValue","setDebouncedValue","useState","useEffect","handler","setTimeout","clearTimeout","Sliders","onSetVolume","onSetTuning","debouncedVolume","tuning","setTuning","debouncedTuning","sliders","tuner","step","min","max","Number","Sustain","onSetSustain","sustain","setSustain","debouncedSustain","left","right","disabled","App","useRef","ready","setReady","current","lastChordNote","setLastChordNote","lastChordType","setLastChordType","keyUpEvent","setKeyUpEvent","pendingChordType","setPendingChordType","render","getStorageKey","storageKey","getPitches","useCallback","stored","localStorage","getItem","parsed","JSON","parse","every","isInteger","err","getChordPitches","indexOf","onChordClick","setItem","stringify","Date","now","onKeyDownChromatic","keyCode","includes","typeKeymap","onKeyDownFifths","listener","ctrlKey","shiftKey","altKey","repeat","code","preventDefault","stopPropagation","document","addEventListener","removeEventListener","app","chords","renderChord","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.96c998be.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"chordbuttons\":\"ChordButtons_chordbuttons__1fCK-\",\"pending\":\"ChordButtons_pending__2QeOF\",\"active\":\"ChordButtons_active__1aWxQ\",\"stop\":\"ChordButtons_stop__3dkpU\"};","import WebAudioFontPlayer from 'webaudiofont';\n\nconst soundFont = (window as any)._tone_0411_FluidR3_GM_sf2_file\n\nexport class AudioFontPlayer {\n  private player;\n  private audioContext;\n  private envelopes = [];\n  private volume = 0.5;\n  private playbackRate = 1.0;\n  private duration = 0.3;\n\n  constructor () {\n    const AudioContextFunc = window.AudioContext || (window as any).webkitAudioContext;\n    this.audioContext = new AudioContextFunc();\n    this.player = new WebAudioFontPlayer();\n    this.player.loader.decodeAfterLoading(this.audioContext, '_tone_0411_FluidR3_GM_sf2_file');\n    // sustain\n    // for (let i = 0; i < soundFont.zones.length; i++){\n    //   soundFont.zones[i].ahdsr = false;\n    // }\n    console.log(this.player, soundFont);\n  }\n\n  queueNote(note: number, duration: number) {\n    const zone = this.player.findZone(this.audioContext, soundFont, note);\n    const baseDetune = zone.originalPitch - 100.0 * zone.coarseTune - zone.fineTune;\n\t\tconst playbackRate = this.playbackRate * Math.pow(2, (100.0 * note - baseDetune) / 1200.0);\n    const envelope = this.player.queueWaveTable(this.audioContext, this.audioContext.destination, soundFont, 0, note, duration, this.volume);\n    envelope.audioBufferSourceNode.playbackRate.cancelScheduledValues(0);\n    envelope.audioBufferSourceNode.playbackRate.setValueAtTime(playbackRate, 0);\n    this.envelopes.push(envelope);\n  }\n\n  playChord(pitches: number[]) {\n    this.stop();\n    pitches.forEach(pitch => this.queueNote(pitch, this.duration));\n  }\n\n  stop() {\n    while (true) {\n      const envelope = this.envelopes.pop();\n      if (!envelope) break;\n      envelope.cancel();\n    }\n  }\n\n  get playing() {\n    return this.envelopes.length > 0;\n  }\n\n  setFreq(freq: number) {\n    this.playbackRate = freq / 440;\n    const pitches = this.envelopes.map(e => e.pitch);\n    this.playChord(pitches);\n  }\n\n  setVolume(volume: number) {\n    this.volume = volume;\n    // it doesn't accept 0\n    if (this.volume === 0) {\n      this.volume = 0.0001;\n    }\n    const pitches = this.envelopes.map(e => e.pitch);\n    this.playChord(pitches);\n  }\n\n  setDuration(duration: number) {\n    this.duration = duration;\n  }\n}\n","import { isEqual } from 'lodash';\n\nexport const NOTES = ['C', 'C♯', 'D', 'E♭', 'E', 'F', 'F♯', 'G', 'A♭', 'A', 'B', 'H'];\nexport const NOTES_CHROMATIC_ORDER = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11];\nexport const NOTES_FIFTHS_ORDER = [6, 1, 8, 3, 10, 5, 0, 7, 2, 9, 4, 11];\nexport const CHORDTYPES = ['', 'm', '7', 'dim', '5', '6', 'm7', 'maj7', 'sus2', 'sus4', 'm6', 'aug'];\n\nconst TUNING = [55, 62, 57];\nconst MAX_POS = 8;\n\nconst CHORD_DB = [];\n\nconst createNotesArr = (notes: number[]) => {\n  const arr = notes.map(n => n % 12);\n  arr.sort((a, b) => a - b);\n  return arr;\n};\n\nconst threeNoteChordItem = (base: number, type: number, notes: number[]) => {\n  return { base, type, notes: createNotesArr(notes) };\n}\n\nconst fourNoteChordItem = (base: number, type: number, notes: number[], fourth: number) => {\n  return [\n    threeNoteChordItem(base, type, [notes[0], notes[1], fourth]),\n    threeNoteChordItem(base, type, [notes[0], fourth, notes[2]]),\n    threeNoteChordItem(base, type, [fourth, notes[1], notes[2]]),\n  ];\n}\n\nconst createDb = () => {\n  for (let i = 0; i < 12; i++) {\n    CHORD_DB.push(\n      threeNoteChordItem(i, 0, [i, i + 4, i + 4 + 3]), // major\n      threeNoteChordItem(i, 1, [i, i + 3, i + 3 + 4]), // minor\n      ...fourNoteChordItem(i, 2, [i, i + 4, i + 4 + 3], i + 4 + 3 + 3), // 7\n      threeNoteChordItem(i, 3, [i, i + 3, i + 6]), // dim\n      threeNoteChordItem(i, 4, [i, i, i + 3 + 4]), // 5\n      threeNoteChordItem(i, 4, [i, i + 3 + 4, i + 3 + 4]), // 5\n      ...fourNoteChordItem(i, 5, [i, i + 4, i + 4 + 3], i + 4 + 3 + 2), // 6\n      ...fourNoteChordItem(i, 6, [i, i + 3, i + 3 + 4], i + 4 + 3 + 3), // m7\n      ...fourNoteChordItem(i, 7, [i, i + 4, i + 4 + 3], i + 4 + 3 + 4), // maj7\n      threeNoteChordItem(i, 8, [i, i + 2, i + 4 + 3]), // sus2\n      threeNoteChordItem(i, 9, [i, i + 5, i + 4 + 3]), // sus4\n      ...fourNoteChordItem(i, 10, [i, i + 3, i + 3 + 4], i + 4 + 3 + 2), // m6\n      threeNoteChordItem(i, 11, [i, i + 4, i + 4 + 4]), // aug\n    );\n  }\n};\ncreateDb();\nconsole.log(CHORD_DB);\n\n// note is zero indexed\nconst pitchToNote = (pitch: number) => {\n  return pitch % 12;\n}\n\nconst getChords = (pitches: number[]) => {\n  const notes = pitches.map(p => pitchToNote(p)).sort((a, b) => a - b);\n  const res = CHORD_DB.filter(item => isEqual(item.notes, notes));\n  return res.map(r => ({ base: r.base, type: r.type }));\n};\n\nconst getDifficulty = (pitches: number[]) => {\n  const positions = pitches.map((pitch, i) => pitch - TUNING[i]);\n  const score = positions.reduce((prev, curr) => curr === 0 ? prev + 2 : prev + curr, 0);\n  return score;\n};\n\n// VALID_CHORDS[note][type] = [pitches];\nconst VALID_CHORDS = [];\n\nfunction init() {\n  for (let i = 0; i < MAX_POS; i++) {\n    for (let j = 0; j < MAX_POS; j++) {\n      for (let k = 0; k < MAX_POS; k++) {\n        const pitches = [TUNING[0] + i, TUNING[1] + j, TUNING[2] + k];\n        const chords = getChords(pitches);\n        chords.forEach(chord => {\n          if (!Array.isArray(VALID_CHORDS[chord.base])) {\n            VALID_CHORDS[chord.base] = [];\n          }\n          if (!Array.isArray(VALID_CHORDS[chord.base][chord.type])) {\n            VALID_CHORDS[chord.base][chord.type] = [];\n          }\n          VALID_CHORDS[chord.base][chord.type].push(pitches);\n        });\n      }\n    }\n  }\n\n  // order by complexity\n  for (let i = 0; i < VALID_CHORDS.length; i++) {\n    for (let j = 0; j < VALID_CHORDS[i].length; j++) {\n      const pitches = VALID_CHORDS[i][j];\n      pitches.sort((a, b) => getDifficulty(a) - getDifficulty(b));\n    }\n  }\n}\n\ninit();\n\nexport function getChordPitches(note: number, type: number) {\n  return VALID_CHORDS[note][type];\n}\n\nexport function getChordPositions(note: number, type: number) {\n  return VALID_CHORDS[note][type].map(pitches => pitches.map((pitch, i) => pitch - TUNING[i]));\n}\n\nexport function positionsToPitches(positions: number[]) {\n  return TUNING.map((t, i) => positions[i] + t);\n}\n\nexport function getAlternativeNames(positions: number[]) {\n  const pitches = positions.map((p, i) => TUNING[i] + p);\n  const chords = getChords(pitches).sort((a, b) => a.type - b.type);\n  return chords.map(c => `${NOTES[c.base]}${CHORDTYPES[c.type]}`);\n}\n\nconsole.log('VALID_CHORDS', VALID_CHORDS);\n","import React from 'react';\nimport { CHORDTYPES, NOTES, NOTES_CHROMATIC_ORDER, NOTES_FIFTHS_ORDER } from './chords';\nimport styles from './ChordButtons.module.scss';\n\ninterface ChordButtonsProps {\n  activeNote: number;\n  activeType: number;\n  pendingType: number;\n  layout: 'chromatic' | 'fifths';\n  setLayout: (layout: 'chromatic' | 'fifths') => void;\n  onClick: (note: number, type: number) => void;\n  onStop: () => void;\n}\n\nexport const CHROMATIC_KEYMAP = ['z', 's', 'x', 'd', 'c', 'v', 'g', 'b', 'h', 'n', 'j', 'm'];\nexport const CHROMATIC_KEYMAP_CODES = ['KeyZ', 'KeyS', 'KeyX', 'KeyD', 'KeyC', 'KeyV', 'KeyG', 'KeyB', 'KeyH', 'KeyN', 'KeyJ', 'KeyM'];\nexport const FIFTHS_KEYMAP = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '0', '-', '='];\nexport const FIFTHS_KEYMAP_CODES_MAJOR = ['Digit1', 'Digit2', 'Digit3', 'Digit4', 'Digit5', 'Digit6', 'Digit7', 'Digit8', 'Digit9', 'Digit0', 'Minus', 'Equal'];\nexport const FIFTHS_KEYMAP_CODES_MINOR = ['KeyQ', 'KeyW', 'KeyE', 'KeyR', 'KeyT', 'KeyY', 'KeyU', 'KeyI', 'KeyO', 'KeyP', 'BracketLeft', 'BracketRight'];\nexport const FIFTHS_KEYMAP_CODES_SEVENTH = ['KeyA', 'KeyS', 'KeyD', 'KeyF', 'KeyG', 'KeyH', 'KeyJ', 'KeyK', 'KeyL', 'Semicolon', 'Quote', 'Backslash'];\n\nexport const ChordButtons: React.FC<ChordButtonsProps> = (props) => {\n  const { activeNote, activeType, pendingType, layout, setLayout, onClick, onStop } = props;\n\n  const renderButtons = (typeIndex: number) => {\n    const order = layout === 'chromatic' ? NOTES_CHROMATIC_ORDER : NOTES_FIFTHS_ORDER;\n    const isButtonActive = (noteIndex: number) => activeType === typeIndex && activeNote === noteIndex;\n\n    return (\n      <tr className={pendingType === typeIndex ? styles.pending : ''} key={typeIndex}>\n        <td>{typeIndex < 9 && layout === 'chromatic' ? typeIndex + 1 : ''}</td>\n        {order.map((noteIndex) => (\n          <td key={noteIndex + typeIndex}>\n            <button\n              className={isButtonActive(noteIndex) ? styles.active : ''}\n              onClick={() => onClick(noteIndex, typeIndex)}\n            >\n              {NOTES[noteIndex]}{CHORDTYPES[typeIndex]}\n            </button>\n          </td>\n        ))}\n      </tr>\n    );\n  }\n\n  const keymap = layout === 'chromatic' ? CHROMATIC_KEYMAP : FIFTHS_KEYMAP;\n  return (\n    <div className={styles.chordbuttons}>\n      <table>\n        <thead>\n          <tr>\n            <td><strong>Key</strong></td>\n            {keymap.map(key => <td key={key}>{key}</td>)}\n          </tr>\n        </thead>\n        <tbody>\n          {CHORDTYPES.map((_, typeIndex) => renderButtons(typeIndex))}\n          <tr>\n            <td>Space</td>\n            <td colSpan={12}>\n              <button className={styles.stop} onClick={onStop}>Stop</button>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n      <label>\n        <input\n          type=\"radio\"\n          name=\"layout\"\n          value=\"chromatic\"\n          checked={layout === 'chromatic'}\n          onChange={(e) => setLayout(e.target.value as any)}\n        />\n        Chromatic\n      </label>\n      &nbsp;&nbsp;&nbsp;&nbsp;\n      <label>\n        <input\n          type=\"radio\"\n          name=\"layout\"\n          value=\"fifths\"\n          checked={layout === 'fifths'}\n          onChange={(e) => setLayout(e.target.value as any)}\n        />\n        Circle of fifths\n      </label>\n    </div>\n  );\n};\n","import React from 'react';\nimport { getAlternativeNames, NOTES } from './chords';\nimport styles from './ChordView.module.scss';\n\ninterface ChordViewProps {\n  isChecked: boolean;\n  positions: [number, number, number];\n  onClick: (positions: number[]) => void;\n}\n\nexport const ChordView: React.FC<ChordViewProps> = (props) => {\n  const { isChecked, positions, onClick } = props;\n\n  const getNote = (baseNote: number, pos: number) => {\n    const index = (baseNote + pos) % 12;\n    const isHighNote = baseNote + pos >= 7 + 12;\n    return isHighNote ? `${NOTES[index]}'` : NOTES[index];\n  }\n\n  return (\n    <div className={styles.wrapper} onClick={() => onClick(positions)}>\n      <table className={styles.chordview}>\n        <thead>\n          <tr>\n            <th colSpan={3}>\n              <input type=\"checkbox\" checked={isChecked} readOnly/>\n            </th>\n          </tr>\n          <tr>\n            <th>{getNote(7, positions[0])}</th>\n            <th>{getNote(14, positions[1])}</th>\n            <th>{getNote(9, positions[2])}</th>\n          </tr>\n        </thead>\n        <tbody>\n          {new Array(7).fill(0).map((_, i) => (\n            <tr key={i}>\n              <td>{positions[0] === i + 1 ? '●' : ''}</td>\n              <td>{positions[1] === i + 1 ? '●' : ''}</td>\n              <td>{positions[2] === i + 1 ? '●' : ''}</td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n      <div className={styles.names}>\n        {getAlternativeNames(positions).map(name =>\n          <React.Fragment key={name}>\n            {name}\n            <br />\n          </React.Fragment>\n        )}\n      </div>\n    </div>\n  )\n};\n","import { useEffect, useState } from \"react\";\n\nexport function useDebounce(value, delay) {\n  // State and setters for debounced value\n  const [debouncedValue, setDebouncedValue] = useState(value);\n  useEffect(\n    () => {\n      // Update debounced value after delay\n      const handler = setTimeout(() => {\n        setDebouncedValue(value);\n      }, delay);\n      // Cancel the timeout if value changes (also on delay change or unmount)\n      // This is how we prevent debounced value from updating if value is changed ...\n      // .. within the delay period. Timeout gets cleared and restarted.\n      return () => {\n        clearTimeout(handler);\n      };\n    },\n    [value, delay] // Only re-call effect if value or delay changes\n  );\n  return debouncedValue;\n}\n","import React, { useEffect, useState } from 'react';\nimport styles from './Sliders.module.scss';\nimport { useDebounce } from './useDebounce';\n\ninterface SlidersProps {\n  onSetVolume: (volume: number) => void;\n  onSetTuning: (tuning: number) => void;\n}\n\nexport const Sliders: React.FC<SlidersProps> = (props) => {\n  const { onSetVolume, onSetTuning } = props;\n  const [volume, setVolume] = useState(0.5);\n  const debouncedVolume = useDebounce(volume, 50);\n  const [tuning, setTuning] = useState(440);\n  const debouncedTuning = useDebounce(tuning, 25);\n\n  useEffect(() => {\n    onSetVolume(debouncedVolume);\n  }, [onSetVolume, debouncedVolume]);\n\n  useEffect(() => {\n    onSetTuning(debouncedTuning);\n  }, [onSetTuning, debouncedTuning]);\n\n  return (\n    <div className={styles.sliders}>\n      <label>\n        Tuning\n        <br />\n        <input\n          className={styles.tuner}\n          type=\"range\"\n          step=\"0.1\"\n          min=\"400\"\n          max=\"500\"\n          value={tuning}\n          onChange={(e) => setTuning(Number(e.target.value))}\n        />\n      </label>\n      <label>\n        Volume\n        <br />\n        <input\n          className={styles.tuner}\n          type=\"range\"\n          step=\"0.02\"\n          min=\"0\"\n          max=\"1\"\n          value={volume}\n          onChange={(e) => setVolume(Number(e.target.value))}\n        />\n      </label>\n      {/* <br />\n      {tuning.toFixed(1)}\n      <br /> */}\n    </div>\n  );\n};\n","import React, { useEffect, useState } from 'react';\nimport styles from './Sustain.module.scss';\nimport { useDebounce } from './useDebounce';\n\ninterface SustainProps {\n  onSetSustain: (sustain: number | null) => void;\n}\n\nexport const Sustain: React.FC<SustainProps> = (props) => {\n  const { onSetSustain } = props;\n  const [sustain, setSustain] = useState(null);\n  const debouncedSustain = useDebounce(sustain, 25);\n\n  useEffect(() => {\n    onSetSustain(debouncedSustain);\n  }, [onSetSustain, debouncedSustain]);\n\n  return (\n    <div className={styles.sustain}>\n      <div className={styles.left}>\n        <label>\n          <input\n            type=\"radio\"\n            name=\"sustain\"\n            value=\"sustain\"\n            checked={sustain === null}\n            onChange={(e) => setSustain(null)}\n          />\n          Sustain\n        </label>\n        &nbsp;&nbsp;&nbsp;&nbsp;\n        <label>\n          <input\n            type=\"radio\"\n            name=\"sustain\"\n            value=\"release\"\n            checked={sustain !== null}\n            onChange={(e) => setSustain(0.3)}\n          />\n          Auto release\n        </label>\n      </div>\n      <div className={styles.right}>\n        <label>\n          Auto release timing\n          <br />\n          <input\n            className={styles.tuner}\n            type=\"range\"\n            step=\"0.02\"\n            min=\"0\"\n            max=\"1\"\n            disabled={sustain === null}\n            value={sustain}\n            onChange={(e) => setSustain(Number(e.target.value))}\n          />\n        </label>\n      </div>\n    </div>\n  );\n};\n","import React, { useCallback, useEffect, useRef, useState } from 'react';\nimport styles from './App.module.scss';\nimport { AudioFontPlayer } from './AudioFontPlayer';\nimport { ChordButtons, CHROMATIC_KEYMAP_CODES, FIFTHS_KEYMAP_CODES_SEVENTH, FIFTHS_KEYMAP_CODES_MINOR, FIFTHS_KEYMAP_CODES_MAJOR } from './ChordButtons';\nimport { CHORDTYPES, getChordPitches, getChordPositions, NOTES, NOTES_FIFTHS_ORDER, positionsToPitches } from './chords';\nimport { ChordView } from './ChordView';\nimport { Sliders } from './Sliders';\nimport { Sustain } from './Sustain';\n\nexport const App: React.FC = () => {\n  const player = useRef(null);\n  const [ready, setReady] = useState(false);\n\n  useEffect(() => {\n    player.current = new AudioFontPlayer();\n    setReady(true);\n  }, []);\n\n  const [lastChordNote, setLastChordNote] = useState(0);\n  const [lastChordType, setLastChordType] = useState(0);\n  const [keyUpEvent, setKeyUpEvent] = useState(true);\n  const [pendingChordType, setPendingChordType] = useState<number>(null);\n  const [layout, setLayout] = useState<'chromatic' | 'fifths'>('chromatic');\n  const [, render] = useState(0);\n\n  const getStorageKey = (note: string, type: string) => `viola-${note}${type}`;\n  const storageKey = getStorageKey(NOTES[lastChordNote], CHORDTYPES[lastChordType]);\n\n  const getPitches = useCallback((note: string, type: string) => {\n    const storageKey = getStorageKey(note, type);\n    const stored = localStorage.getItem(storageKey);\n    if (stored) {\n      try {\n        const parsed = JSON.parse(stored);\n        if (Array.isArray(parsed) && parsed.length === 3 && parsed.every(p => Number.isInteger(p))) {\n          console.log(parsed, positionsToPitches(parsed));\n          return positionsToPitches(parsed);\n        }\n      } catch (err) {}\n    }\n\n    return getChordPitches(\n      NOTES.indexOf(note),\n      CHORDTYPES.indexOf(type)\n    )[0];\n  }, []);\n\n  const playChord = useCallback((note: number, type: number) => {\n    const pitches = getPitches(NOTES[note], CHORDTYPES[type]);\n\n    setLastChordNote(note);\n    setLastChordType(type);\n    setPendingChordType(null);\n\n    player.current.playChord(pitches);\n  }, [getPitches])\n\n  const positions = getChordPositions(lastChordNote, lastChordType) ?? [];\n\n  const onChordClick = (positions: number[]) => {\n    const pitches = positionsToPitches(positions);\n    player.current.playChord(pitches);\n    localStorage.setItem(storageKey, JSON.stringify(positions));\n    render(Date.now()); // needed for the checkbox above chord icons\n  };\n\n  const onStop = () => {\n    player.current.stop();\n  };\n\n  const onKeyDownChromatic = useCallback((key: string, keyCode: string) => {\n    console.log(keyCode);\n    if (CHROMATIC_KEYMAP_CODES.includes(keyCode)) {\n      playChord(CHROMATIC_KEYMAP_CODES.indexOf(keyCode) % 12, pendingChordType ?? lastChordType);\n      setPendingChordType(null);\n      return true;\n    }\n\n    const typeKeymap = ['1', '2', '3', '4', '5', '6', '7', '8', '9'];\n    if (typeKeymap.includes(key)) {\n      setPendingChordType(typeKeymap.indexOf(key));\n      return true;\n    }\n\n    if (key === ' ') {\n      onStop();\n      return true;\n    }\n\n    return false;\n  }, [pendingChordType, lastChordType, playChord]);\n\n  const onKeyDownFifths = useCallback((key: string, keyCode: string) => {\n    console.log(keyCode);\n    if (FIFTHS_KEYMAP_CODES_MAJOR.includes(keyCode)) {\n      playChord(NOTES_FIFTHS_ORDER[FIFTHS_KEYMAP_CODES_MAJOR.indexOf(keyCode) % 12], 0);\n      setPendingChordType(null);\n      return true;\n    }\n\n    if (FIFTHS_KEYMAP_CODES_MINOR.includes(keyCode)) {\n      playChord(NOTES_FIFTHS_ORDER[FIFTHS_KEYMAP_CODES_MINOR.indexOf(keyCode) % 12], 1);\n      setPendingChordType(null);\n      return true;\n    }\n\n    if (FIFTHS_KEYMAP_CODES_SEVENTH.includes(keyCode)) {\n      playChord(NOTES_FIFTHS_ORDER[FIFTHS_KEYMAP_CODES_SEVENTH.indexOf(keyCode) % 12], 2);\n      setPendingChordType(null);\n      return true;\n    }\n\n    if (key === ' ') {\n      onStop();\n      return true;\n    }\n\n    return false;\n  }, [playChord]);\n\n  useEffect(() => {\n    const listener = (e) => {\n      if (e.ctrlKey || e.shiftKey || e.altKey) return;\n      if (e.repeat) return;\n      const res = layout === 'chromatic' ? onKeyDownChromatic(e.key, e.code) : onKeyDownFifths(e.key, e.code);\n      if (res) {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n    }\n    document.addEventListener(\"keydown\", listener);\n    return () => document.removeEventListener(\"keydown\", listener);\n  }, [layout, onKeyDownChromatic, onKeyDownFifths]);\n\n  useEffect(() => {\n    if (!keyUpEvent) return;\n    const listener = (e) => {\n      if (e.ctrlKey || e.shiftKey || e.altKey) return;\n      if (CHROMATIC_KEYMAP_CODES.includes(e.code)\n        || FIFTHS_KEYMAP_CODES_MAJOR.includes(e.code)\n        || FIFTHS_KEYMAP_CODES_MINOR.includes(e.code)\n        || FIFTHS_KEYMAP_CODES_SEVENTH.includes(e.code)){\n        onStop();\n        e.preventDefault();\n        e.stopPropagation();\n        return true;\n      }\n    }\n    document.addEventListener(\"keyup\", listener);\n    return () => document.removeEventListener(\"keyup\", listener);\n  }, [keyUpEvent]);\n\n  const renderChord = (pos: [number, number, number]) => {\n    const key = JSON.stringify(pos);\n    const isChecked = key === localStorage.getItem(storageKey);\n\n    return (\n      <ChordView\n        key={key}\n        positions={pos}\n        onClick={onChordClick}\n        isChecked={isChecked}\n      />\n    );\n  };\n\n  const onSetTuning = useCallback((freq: number) => {\n    player.current.setFreq(freq);\n  }, []);\n\n  const onSetSustain = useCallback((duration: number) => {\n    if (duration === null) {\n      player.current.setDuration(999);\n      setKeyUpEvent(true);\n    } else {\n      player.current.setDuration(duration);\n      setKeyUpEvent(false);\n    }\n  }, []);\n\n  const onSetVolume = useCallback((volume: number) => {\n    player.current.setVolume(volume);\n  }, []);\n\n  if (!ready) {\n    return null;\n  }\n\n  return (\n    <div className={styles.app}>\n      <ChordButtons\n        activeNote={lastChordNote}\n        activeType={lastChordType}\n        pendingType={pendingChordType}\n        onClick={playChord}\n        onStop={onStop}\n        layout={layout}\n        setLayout={setLayout}\n      />\n\n      <Sustain\n        onSetSustain={onSetSustain}\n      />\n\n      <Sliders\n        onSetTuning={onSetTuning}\n        onSetVolume={onSetVolume}\n      />\n      \n      <div className={styles.chords}>\n        {positions.map(pos => renderChord(pos))}\n      </div>\n    </div>\n  );\n};\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"sustain\":\"Sustain_sustain__yapZz\",\"left\":\"Sustain_left__F1938\",\"right\":\"Sustain_right__3zI1A\",\"tuner\":\"Sustain_tuner__3wHn5\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"chordview\":\"ChordView_chordview__1UQS7\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"sliders\":\"Sliders_sliders__lzxZi\",\"tuner\":\"Sliders_tuner__vf4HX\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"App_app__2ziFi\",\"chords\":\"App_chords__7aOCV\"};"],"sourceRoot":""}